<!DOCTYPE html>
<html>
<head>
    <title>Ultimate Quiz</title>
    <style>
        :root { --primary: #6C63FF; --secondary: #3f3d56; --success: #2ecc71; --danger: #e74c3c; }
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Poppins', sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0;
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px);
            padding: 40px; border-radius: 20px; box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            width: 450px; text-align: center; transform: translateY(0); transition: 0.3s;
        }
        .progress-container { width: 100%; background: #eee; height: 8px; border-radius: 10px; margin-bottom: 20px; overflow: hidden; }
        #progress-bar { width: 0%; height: 100%; background: var(--primary); transition: 0.4s; }
        .option-label {
            display: block; background: #f1f3f8; padding: 15px; margin: 10px 0; border-radius: 12px;
            cursor: pointer; transition: all 0.2s; border: 2px solid transparent;
        }
        .option-label:hover { transform: scale(1.02); background: #e8ebf3; border-color: var(--primary); }
        input[type="radio"]:checked + span { font-weight: bold; color: var(--primary); }
        .timer-circle { font-size: 24px; font-weight: bold; color: var(--danger); margin-bottom: 15px; }
        .hidden { display: none; }
        .btn { background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-size: 16px; box-shadow: 0 4px 15px rgba(108, 99, 255, 0.4); }
        input[type="text"] { width: 100%; padding: 12px; margin-bottom: 20px; border-radius: 8px; border: 1px solid #ddd; }
    </style>
</head>
<body>

<div class="glass-card">
    <div id="start-screen">
        <h2>Enter Your Name</h2>
        <input type="text" id="p_name" placeholder="Ex: QuizMaster" required>
        <button class="btn" onclick="startQuiz()">Start Quiz</button>
    </div>

    <div id="quiz-content" class="hidden">
        <div class="timer-circle">Time: <span id="timer">30</span>s</div>
        <div class="progress-container"><div id="progress-bar"></div></div>
        
        <form method="POST" id="quizForm">
            {% csrf_token %}
            <input type="hidden" name="player_name" id="hidden_name">
            {% for q in questions %}
            <div class="q-step {% if not forloop.first %}hidden{% endif %}" id="q-{{ forloop.index0 }}">
                <h3>{{ q.question_text }}</h3>
                <div style="text-align: left;">
                    <label class="option-label"><input type="radio" name="question_{{ q.id }}" value="{{ q.option1 }}"> <span>{{ q.option1 }}</span></label>
                    <label class="option-label"><input type="radio" name="question_{{ q.id }}" value="{{ q.option2 }}"> <span>{{ q.option2 }}</span></label>
                    <label class="option-label"><input type="radio" name="question_{{ q.id }}" value="{{ q.option3 }}"> <span>{{ q.option3 }}</span></label>
                    <label class="option-label"><input type="radio" name="question_{{ q.id }}" value="{{ q.option4 }}"> <span>{{ q.option4 }}</span></label>
                </div>
                {% if not forloop.last %}<button type="button" class="btn" onclick="nextQ()">Next</button>
                {% else %}<button type="submit" class="btn">Finish</button>{% endif %}
            </div>
            {% endfor %}
        </form>
    </div>
</div>

<script>
    let current = 0;
    const steps = document.querySelectorAll('.q-step');
    let timeLeft = 30;
    let timer;

    function startQuiz() {
        const name = document.getElementById('p_name').value;
        if (!name) return alert("Enter a name!");
        document.getElementById('hidden_name').value = name;
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('quiz-content').classList.remove('hidden');
        runTimer();
    }

    function runTimer() {
        timeLeft = 30;
        document.getElementById('timer').innerText = timeLeft;
        document.getElementById('progress-bar').style.width = ((current + 1) / steps.length * 100) + "%";
        clearInterval(timer);
        timer = setInterval(() => {
            timeLeft--;
            document.getElementById('timer').innerText = timeLeft;
            if (timeLeft <= 0) nextQ();
        }, 1000);
    }

    function nextQ() {
        if (current < steps.length - 1) {
            steps[current].classList.add('hidden');
            current++;
            steps[current].classList.remove('hidden');
            runTimer();
        } else { document.getElementById('quizForm').submit(); }
    }
</script>
</body>
</html>